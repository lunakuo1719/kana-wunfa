<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, viewport-fit=cover">
<title>å…”å…”æ–‡æ³•è¨ä¼åœ˜ - å‹•ç•«åŠ å¼·ç‰ˆ</title>

<style>
:root {
    --kanahei-pink: #fce4ec; 
    --kanahei-rose: #f06292; 
    --kanahei-brown: #6d4c41; 
    --kanahei-cream: #fff9c4; 
    --kanahei-correct: #ff80ab; 
}

* { box-sizing: border-box; font-family: 'openhuninn', sans-serif; font-weight: 900; }

body { margin: 0; padding: 10px; background-color: var(--kanahei-pink); display: flex; justify-content: center; align-items: center; min-height: 100vh; overflow: hidden; }

.card {
    width: 100%; max-width: 500px; background: white;
    border: 6px solid var(--kanahei-brown);
    border-radius: 45px; padding: 25px;
    box-shadow: 0px 12px 0px var(--kanahei-rose);
    position: relative; text-align: center;
    z-index: 10;
}

/* å³ä¸Šè§’ Home æŒ‰éˆ• */
.home-btn { position: absolute; top: 20px; right: 20px; width: 45px; cursor: pointer; z-index: 100; }
.home-btn img { width: 100%; height: auto; }

/* é€²åº¦æ¢èˆ‡ PåŠ©è·‘æ­¥å®¹å™¨ */
.progress-container { position: relative; height: 60px; margin-top: 10px; }
.piske-runner { 
    position: absolute; bottom: 15px; left: 0%; 
    width: 40px; height: 40px; transition: left 0.4s ease;
    margin-left: -20px; /* ä¿®æ­£ PåŠ©ä¸­å¿ƒé» */
}
.bar-outer { position: absolute; bottom: 0; width: 100%; height: 16px; background: var(--kanahei-cream); border: 3px solid var(--kanahei-brown); border-radius: 10px; overflow: hidden; }
.bar-inner { height: 100%; width: 0%; background: var(--kanahei-correct); transition: width 0.4s; }

/* å…”å…”åŠ æ²¹ç«™ (ç­”é¡Œå›é¥‹åœ–) */
.usagi-feedback { 
    position: absolute; top: -80px; left: 50%; transform: translateX(-50%);
    width: 100px; opacity: 0; transition: 0.3s; pointer-events: none;
}
.show-usagi { opacity: 1; top: -100px; }

/* é¸é …èˆ‡ç¿»è­¯ */
.btn-choice { background: white; margin-bottom: 12px; font-size: 19px; border: 3px solid var(--kanahei-brown); border-radius: 22px; width: 100%; padding: 16px; text-align: left; display: block; cursor: pointer; color: var(--kanahei-brown); }
.choice-correct { background-color: var(--kanahei-correct) !important; color: white !important; }
.text-reveal-correct { color: #e91e63 !important; transform: scale(1.05); }
.translation-box { background: #fff8e1; padding: 15px; border-radius: 20px; margin-top: 10px; font-size: 18px; text-align: left; border: 3px dashed var(--kanahei-rose); }

/* æ„›å¿ƒå‹•ç•« */
.heart { position: fixed; font-size: 25px; color: var(--kanahei-rose); pointer-events: none; z-index: 999; animation: fall linear forwards; }
@keyframes fall { to { transform: translateY(100vh) rotate(360deg); opacity: 0; } }

.hidden { display: none; }
.main-btn { padding: 15px 40px; font-size: 22px; border-radius: 35px; background: var(--kanahei-rose); color: white; border: 4px solid var(--kanahei-brown); cursor: pointer; box-shadow: 0 6px 0 var(--kanahei-brown); }
</style>
</head>
<body>

<div class="card">
    <div id="home-icon" class="home-btn hidden" onclick="goHome()">
        <img src="https://img.icons8.com/color/96/home--v1.png" alt="Home">
    </div>

    <img id="usagi-act" src="" class="usagi-feedback">

    <div id="dashboard">
        <h2 style="color: var(--kanahei-rose); font-size: 30px;">å…”å…”æ–‡æ³•è¨ä¼åœ˜</h2>
        <div style="font-size: 50px; margin: 20px;">ğŸ°ğŸ­ğŸ¥</div>
        <div style="background: var(--kanahei-cream); padding: 15px; border-radius: 20px; border: 3px solid var(--kanahei-brown); margin-bottom: 20px;">
            <p>å·²ç†Ÿç·´é¡Œæ•¸ï¼š<span id="mastered-count">0</span></p>
            <p>ç›®å‰é—œå¡ï¼šLevel <span id="current-level-display">1</span></p>
        </div>
        <button class="main-btn" onclick="startCurrentLevel()">é–‹å§‹è¨ä¼ï¼</button>
    </div>

    <div id="game-zone" class="hidden">
        <div style="text-align: left;">
            <div style="background: var(--kanahei-rose); color: white; display: inline-block; padding: 3px 15px; border-radius: 15px;">Level <span id="level-num">1</span></div>
        </div>
        
        <div class="progress-container">
            <img id="piske-img" src="https://img.icons8.com/color/96/bird.png" class="piske-runner">
            <div class="bar-outer"><div class="bar-inner" id="progress-bar"></div></div>
        </div>
        
        <div class="word-text" id="q-text" style="text-align:left; font-size:22px; margin:15px 0;"></div>
        <div id="choices-area"></div>
        
        <div id="hint-area" class="translation-box hidden">
            <span id="hint-text"></span>
        </div>
    </div>

    <div id="finish-zone" class="hidden">
        <div style="font-size: 60px;">ğŸ†</div>
        <h2 style="color: var(--kanahei-rose);">æœ¬çµ„æ”»ç•¥æˆåŠŸï¼</h2>
        <button class="main-btn" onclick="nextLevel()">æŒ‘æˆ°ä¸‹ä¸€çµ„</button>
    </div>
</div>

<script>
// åœ–ç‰‡ç¶²å€é…ç½®å€ (ä¹‹å¾Œå¦³å¯ä»¥è‡ªè¡Œæ›æˆå¡å¨œèµ«æ‹‰çš„åœ–)
const IMGS = {
    usagi_happy: "https://img.icons8.com/color/96/rabbit.png", // ç­”å°æ™‚å‡ºç¾çš„å…”å…”
    usagi_sad: "https://img.icons8.com/color/96/sad-rabbit.png",  // ç­”éŒ¯æ™‚å‡ºç¾çš„å…”å…”
    piske: "https://img.icons8.com/color/96/bird.png"          // é€²åº¦æ¢ä¸Šçš„ PåŠ©
};

const allQuestions = [
    { q: "This is _______ elephant.", opts: ["a", "an", "X", "the"], a: "an", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™æ˜¯ä¸€éš»å¤§è±¡ã€‚" },
    { q: "I _______ a teacher.", opts: ["am", "is", "were", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘æ˜¯ä¸€ä½è€å¸«ã€‚" },
    { q: "His sons _______ good boys.", opts: ["is", "are", "do", "have"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–çš„å…’å­å€‘æ˜¯å¥½ç”·å­©ã€‚" },
    { q: "They _______ cats.", opts: ["is am", "are", "be", "X"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šç‰ å€‘æ˜¯è²“ã€‚" },
    { q: "The moon _______ yellow.", opts: ["was", "were", "is", "am"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šæœˆäº®æ˜¯é»ƒè‰²çš„ã€‚" },
    { q: "They _______ students.", opts: ["is", "are", "be", "am"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘æ˜¯å­¸ç”Ÿã€‚" },
    { q: "She _______ a doctor.", opts: ["do", "does", "are", "is"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šå¥¹æ˜¯ä¸€ä½é†«ç”Ÿã€‚" },
    { q: "He _______ many books.", opts: ["is", "be", "have", "has"], a: "has", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–æœ‰å¾ˆå¤šæ›¸ã€‚" },
    { q: "We _______ many pens.", opts: ["is", "be", "have", "has"], a: "have", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å€‘æœ‰å¾ˆå¤šç­†ã€‚" },
    { q: "A teacher works in a _______.", opts: ["school", "ship", "car", "train"], a: "school", note: "ä¸­æ–‡ç¿»è­¯ï¼šè€å¸«åœ¨å­¸æ ¡è£¡å·¥ä½œã€‚" },
    { q: "They have _______ dogs.", opts: ["twelve", "a", "one", "an"], a: "twelve", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘æœ‰12éš»ç‹—ã€‚" },
    { q: "We like _______ daughters.", opts: ["our", "yours", "us", "you"], a: "our", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å€‘å–œæ­¡æˆ‘å€‘çš„å¥³å…’å€‘ã€‚" },
    { q: "_______ house is beautiful.", opts: ["I", "My", "Me", "Mine"], a: "My", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘çš„æˆ¿å­æ˜¯æ¼‚äº®çš„ã€‚" },
    { q: "Banana is _______.", opts: ["red", "brown", "yellow", "blue"], a: "yellow", note: "ä¸­æ–‡ç¿»è­¯ï¼šé¦™è•‰æ˜¯é»ƒè‰²çš„ã€‚" },
    { q: "Trees are _______.", opts: ["pink", "red", "black", "green"], a: "green", note: "ä¸­æ–‡ç¿»è­¯ï¼šæ¨¹æ˜¯ç¶ è‰²çš„ã€‚" },
    { q: "I am _______ teacher.", opts: ["he", "me", "they", "his"], a: "his", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘æ˜¯ä»–çš„è€å¸«ã€‚" },
    { q: "He is _______ teacher.", opts: ["mine", "my", "yours", "hers"], a: "my", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–æ˜¯æˆ‘çš„è€å¸«ã€‚" },
    { q: "We are talking _______ the book.", opts: ["in", "about", "on", "under"], a: "about", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å€‘æ­£åœ¨èªªé‚£æœ¬æ›¸ã€‚" },
    { q: "_______ can fly.", opts: ["Dogs", "Cats", "Birds", "Fish"], a: "Birds", note: "ä¸­æ–‡ç¿»è­¯ï¼šé³¥æœƒé£›ã€‚" },
    { q: "I drank _______ for breakfast.", opts: ["milk", "books", "theaters", "rabbits"], a: "milk", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å–ç‰›å¥¶ç•¶æ—©é¤ã€‚" },
    { q: "I have two _______.", opts: ["eyes", "nose", "mouth", "face"], a: "eyes", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘æœ‰å…©éš»çœ¼ç›ã€‚" },
    { q: "He _______ three sisters.", opts: ["is", "are", "has", "have"], a: "has", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–æœ‰ä¸‰å€‹å§å¦¹ã€‚" },
    { q: "They _______ three brothers.", opts: ["is", "are", "has", "have"], a: "have", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘æœ‰ä¸‰å€‹å…„å¼Ÿã€‚" },
    { q: "My father _______ a car.", opts: ["has", "have", "is", "are"], a: "has", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘çˆ¶è¦ªæœ‰ä¸€è¼›è»Šã€‚" },
    { q: "The boy _______ a kite.", opts: ["has", "have", "is", "are"], a: "has", note: "ä¸­æ–‡ç¿»è­¯ï¼šç”·å­©æœ‰ä¸€éš»é¢¨ç®ã€‚" },
    { q: "The boys _______ a kite.", opts: ["has", "have", "is", "are"], a: "have", note: "ä¸­æ–‡ç¿»è­¯ï¼šç”·å­©å€‘æœ‰ä¸€éš»é¢¨ç®ã€‚" },
    { q: "A bird _______ two wings.", opts: ["has", "have", "is", "are"], a: "has", note: "ä¸­æ–‡ç¿»è­¯ï¼šä¸€éš»é³¥æœ‰å…©éš»ç¿…è†€ã€‚" },
    { q: "Birds _______ wings.", opts: ["has", "have", "is", "are"], a: "have", note: "ä¸­æ–‡ç¿»è­¯ï¼šé³¥æœ‰ç¿…è†€ã€‚" },
    { q: "He _______ my friend.", opts: ["is", "are", "am", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–æ˜¯æˆ‘çš„æœ‹å‹ã€‚" },
    { q: "We _______ friends.", opts: ["is", "are", "am", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å€‘æ˜¯æœ‹å‹ã€‚" },
    { q: "I _______ hungry.", opts: ["is", "are", "am", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘é¤“äº†ã€‚" },
    { q: "The cats _______ hungry.", opts: ["is", "are", "am", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šè²“é¤“äº†ã€‚" },
    { q: "He _______ go to school.", opts: ["don't", "doesn't", "isn't", "aren't"], a: "doesn't", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–ä¸ä¸Šå­¸ã€‚" },
    { q: "They _______ go to school.", opts: ["don't", "doesn't", "isn't", "aren't"], a: "don't", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘ä¸ä¸Šå­¸ã€‚" },
    { q: "He _______ like to play tennis.", opts: ["don't", "doesn't", "isn't", "aren't"], a: "doesn't", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–ä¸å–œæ­¡æ‰“ç¶²çƒã€‚" },
    { q: "I _______ like to play tennis.", opts: ["don't", "doesn't", "isn't", "aren't"], a: "don't", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘ä¸å–œæ­¡æ‰“ç¶²çƒã€‚" },
    { q: "We _______ like to play tennis.", opts: ["don't", "doesn't", "isn't", "aren't"], a: "don't", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å€‘ä¸å–œæ­¡æ‰“ç¶²çƒã€‚" },
    { q: "The boy _______ like to play tennis.", opts: ["don't", "doesn't", "isn't", "aren't"], a: "doesn't", note: "ä¸­æ–‡ç¿»è­¯ï¼šé‚£å€‹ç”·å­©ä¸å–œæ­¡æ‰“ç¶²çƒã€‚" },
    { q: "The boys _______ like to play tennis.", opts: ["don't", "doesn't", "isn't", "aren't"], a: "don't", note: "ä¸­æ–‡ç¿»è­¯ï¼šé‚£äº›ç”·å­©ä¸å–œæ­¡æ‰“ç¶²çƒã€‚" },
    { q: "It _______ rain in winter.", opts: ["don't", "doesn't", "isn't", "aren't"], a: "doesn't", note: "ä¸­æ–‡ç¿»è­¯ï¼šå†¬å¤©ä¸ä¸‹é›¨ã€‚" },
    { q: "He _______ very tall.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å¾ˆé«˜ã€‚" },
    { q: "They _______ very tall.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘å¾ˆé«˜ã€‚" },
    { q: "I _______ a tall boy.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘æ˜¯ä¸€å€‹é«˜å€‹å­çš„ç”·å­©ã€‚" },
    { q: "He _______ a tall boy.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–æ˜¯ä¸€å€‹é«˜å€‹å­çš„ç”·å­©ã€‚" },
    { q: "I _______ hot.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å¾ˆç†±ã€‚" },
    { q: "He _______ hot.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å¾ˆç†±ã€‚" },
    { q: "They _______ hot.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘å¾ˆç†±ã€‚" },
    { q: "I _______ thirsty.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘æ¸´äº†ã€‚" },
    { q: "He _______ thirsty.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–æ¸´äº†ã€‚" },
    { q: "They _______ thirsty.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘æ¸´äº†ã€‚" },
    { q: "We _______ thirsty.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å€‘æ¸´äº†ã€‚" },
    { q: "It _______ hot today.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»Šå¤©å¤©æ°£ç†±ã€‚" },
    { q: "It _______ cold today.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»Šå¤©å¤©æ°£å†·ã€‚" },
    { q: "The water _______ cold.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šæ°´æ˜¯å†·çš„ã€‚" },
    { q: "The flowers _______ beautiful.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šèŠ±æ˜¯æ¼‚äº®çš„ã€‚" },
    { q: "The book _______ new.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™æœ¬æ›¸æ˜¯æ–°çš„ã€‚" },
    { q: "The books _______ new.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™äº›æ›¸æ˜¯æ–°çš„ã€‚" },
    { q: "He _______ my brother.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–æ˜¯æˆ‘çš„å…„å¼Ÿã€‚" },
    { q: "They _______ my brothers.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘æ˜¯æˆ‘çš„å…„å¼Ÿã€‚" },
    { q: "She _______ my sister.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šå¥¹æ˜¯æˆ‘çš„å§å¦¹ã€‚" },
    { q: "They _______ my sisters.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šå¥¹å€‘æ˜¯æˆ‘çš„å§å¦¹ã€‚" },
    { q: "I _______ happy.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å¾ˆå¿«æ¨‚ã€‚" },
    { q: "He _______ happy.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å¾ˆå¿«æ¨‚ã€‚" },
    { q: "They _______ happy.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘å¾ˆå¿«æ¨‚ã€‚" },
    { q: "I _______ sad.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å¾ˆæ†‚å‚·ã€‚" },
    { q: "He _______ sad.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å¾ˆæ†‚å‚·ã€‚" },
    { q: "They _______ sad.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘å¾ˆæ†‚å‚·ã€‚" },
    { q: "I _______ thin.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å¾ˆç˜¦ã€‚" },
    { q: "He _______ thin.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å¾ˆç˜¦ã€‚" },
    { q: "They _______ thin.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘å¾ˆç˜¦ã€‚" },
    { q: "I _______ fat.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å¾ˆèƒ–ã€‚" },
    { q: "He _______ fat.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å¾ˆèƒ–ã€‚" },
    { q: "They _______ fat.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘å¾ˆèƒ–ã€‚" },
    { q: "I _______ a student.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘æ˜¯ä¸€å€‹å­¸ç”Ÿã€‚" },
    { q: "He _______ a student.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–æ˜¯ä¸€å€‹å­¸ç”Ÿã€‚" },
    { q: "They _______ students.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘æ˜¯å­¸ç”Ÿã€‚" },
    { q: "You _______ students.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä½ å€‘æ˜¯å­¸ç”Ÿã€‚" },
    { q: "I _______ a teacher.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘æ˜¯ä¸€ä½è€å¸«ã€‚" },
    { q: "She _______ a teacher.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šå¥¹æ˜¯ä¸€ä½è€å¸«ã€‚" },
    { q: "They _______ teachers.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘æ˜¯è€å¸«ã€‚" },
    { q: "We _______ teachers.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å€‘æ˜¯è€å¸«ã€‚" },
    { q: "The teacher _______ a good man.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™ä½è€å¸«æ˜¯ä¸€å€‹å¥½äººã€‚" },
    { q: "The teachers _______ good men.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™äº›è€å¸«æ˜¯å¥½äººã€‚" },
    { q: "My father _______ a doctor.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘çˆ¶è¦ªæ˜¯ä¸€ä½é†«ç”Ÿã€‚" },
    { q: "My mother _______ a nurse.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘æ¯è¦ªæ˜¯ä¸€ä½è­·å£«ã€‚" },
    { q: "His parents _______ doctors.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–çš„çˆ¶æ¯è¦ªæ˜¯é†«ç”Ÿã€‚" },
    { q: "This _______ a desk.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™æ˜¯ä¸€å¼µæ›¸æ¡Œã€‚" },
    { q: "These _______ desks.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™äº›æ˜¯æ›¸æ¡Œã€‚" },
    { q: "That _______ a chair.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šé‚£æ˜¯ä¸€å¼µæ¤…å­ã€‚" },
    { q: "Those _______ chairs.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šé‚£äº›æ˜¯æ¤…å­ã€‚" },
    { q: "The pen _______ blue.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™æç­†æ˜¯è—è‰²çš„ã€‚" },
    { q: "The pens _______ blue.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™äº›ç­†æ˜¯è—è‰²çš„ã€‚" },
    { q: "I _______ in the room.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘åœ¨æˆ¿é–“è£¡ã€‚" },
    { q: "He _______ in the room.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–åœ¨æˆ¿é–“è£¡ã€‚" },
    { q: "They _______ in the room.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘åœ¨æˆ¿é–“è£¡ã€‚" },
    { q: "My father _______ in the room.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘çˆ¶è¦ªåœ¨æˆ¿é–“è£¡ã€‚" },
    { q: "The book _______ on the table.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™æœ¬æ›¸åœ¨æ¡Œå­ä¸Šã€‚" },
    { q: "The books _______ on the table.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™äº›æ›¸åœ¨æ¡Œå­ä¸Šã€‚" },
    { q: "The cat _______ under the table.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™éš»è²“åœ¨æ¡Œå­ä¸‹é¢ã€‚" },
    { q: "The cats _______ under the table.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™äº›è²“åœ¨æ¡Œå­ä¸‹é¢ã€‚" },
    { q: "I _______ ten years old.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘åæ­²ã€‚" },
    { q: "He _______ eleven years old.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–åä¸€æ­²ã€‚" },
    { q: "They _______ twelve years old.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘åäºŒæ­²ã€‚" },
    { q: "I _______ busy.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å¾ˆå¿™ã€‚" },
    { q: "He _______ busy.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å¾ˆå¿™ã€‚" },
    { q: "They _______ busy.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘å¾ˆå¿™ã€‚" },
    { q: "We _______ busy.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å€‘å¾ˆå¿™ã€‚" },
    { q: "I _______ tired.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å¾ˆç´¯ã€‚" },
    { q: "She _______ tired.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šå¥¹å¾ˆç´¯ã€‚" },
    { q: "They _______ tired.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘å¾ˆç´¯ã€‚" },
    { q: "We _______ tired.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å€‘å¾ˆç´¯ã€‚" },
    { q: "My mother _______ busy.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘æ¯è¦ªå¾ˆå¿™ã€‚" },
    { q: "My sisters _______ busy.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘çš„å§å¦¹å€‘å¾ˆå¿™ã€‚" },
    { q: "I _______ sorry.", opts: ["am", "is", "are", "be"], a: "am", note: "ä¸­æ–‡ç¿»è­¯ï¼šæˆ‘å¾ˆæŠ±æ­‰ã€‚" },
    { q: "He _______ sorry.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å¾ˆæŠ±æ­‰ã€‚" },
    { q: "They _______ sorry.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šä»–å€‘å¾ˆæŠ±æ­‰ã€‚" },
    { q: "The apple _______ red.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™é¡†è˜‹æœæ˜¯ç´…è‰²çš„ã€‚" },
    { q: "The apples _______ red.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šé€™äº›è˜‹æœæ˜¯ç´…è‰²çš„ã€‚" },
    { q: "The sky _______ blue.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šå¤©ç©ºæ˜¯è—è‰²çš„ã€‚" },
    { q: "The stars _______ bright.", opts: ["am", "is", "are", "be"], a: "are", note: "ä¸­æ–‡ç¿»è­¯ï¼šæ˜Ÿæ˜Ÿæ˜¯æ˜äº®çš„ã€‚" },
    { q: "The sun _______ bright.", opts: ["am", "is", "are", "be"], a: "is", note: "ä¸­æ–‡ç¿»è­¯ï¼šå¤ªé™½æ˜¯æ˜äº®çš„ã€‚" },
];

let userData = JSON.parse(localStorage.getItem('kana_v2')) || { mastered: 0, currentLevel: 0 };
let currentGroup = [];
let totalInGroup = 20;
let isLocked = false;

function init() {
    document.getElementById('mastered-count').innerText = userData.mastered;
    document.getElementById('current-level-display').innerText = userData.currentLevel + 1;
    document.getElementById('piske-img').src = IMGS.piske;
}

function startCurrentLevel() {
    const startIdx = userData.currentLevel * 20;
    const group = allQuestions.slice(startIdx, startIdx + 20);
    if (group.length === 0) return alert("å…¨éƒ¨å®Œæˆå›‰ï¼");
    currentGroup = shuffle([...group]);
    totalInGroup = currentGroup.length;
    document.getElementById('dashboard').classList.add('hidden');
    document.getElementById('game-zone').classList.remove('hidden');
    document.getElementById('home-icon').classList.remove('hidden');
    renderQuestion();
}

function renderQuestion() {
    isLocked = false;
    if (currentGroup.length === 0) return showFinish();

    const data = currentGroup[0];
    document.getElementById('q-text').innerText = data.q;
    document.getElementById('hint-text').innerText = data.note;
    document.getElementById('hint-area').classList.add('hidden');
    
    const area = document.getElementById('choices-area');
    area.innerHTML = "";
    data.opts.forEach(opt => {
        const btn = document.createElement('button');
        btn.className = "btn-choice";
        btn.innerText = opt;
        btn.onclick = () => handleSelect(opt, btn);
        area.appendChild(btn);
    });

    // æ›´æ–°é€²åº¦èˆ‡ PåŠ©ä½ç½®
    const solved = totalInGroup - currentGroup.length;
    const percent = (solved / totalInGroup) * 100;
    document.getElementById('progress-bar').style.width = percent + "%";
    document.getElementById('piske-img').style.left = percent + "%";
}

function handleSelect(selected, btn) {
    if (isLocked) return;
    isLocked = true;
    const currentItem = currentGroup[0];
    const fb = document.getElementById('usagi-act');
    document.getElementById('hint-area').classList.remove('hidden');

    if (selected === currentItem.a) {
        btn.classList.add('choice-correct');
        userData.mastered++;
        fb.src = IMGS.usagi_happy;
        fb.classList.add('show-usagi');
        
        setTimeout(() => {
            fb.classList.remove('show-usagi');
            currentGroup.shift();
            saveData();
            renderQuestion();
        }, 1200);
    } else {
        document.querySelectorAll('.btn-choice').forEach(b => {
            if (b.innerText === currentItem.a) b.classList.add('text-reveal-correct');
        });
        fb.src = IMGS.usagi_sad;
        fb.classList.add('show-usagi');

        setTimeout(() => {
            fb.classList.remove('show-usagi');
            const failItem = currentGroup.shift();
            currentGroup.push(failItem);
            renderQuestion();
        }, 1600);
    }
}

function showFinish() {
    document.getElementById('game-zone').classList.add('hidden');
    document.getElementById('finish-zone').classList.remove('hidden');
    createHearts(); // ç‘æ„›å¿ƒ
}

function createHearts() {
    for (let i = 0; i < 30; i++) {
        setTimeout(() => {
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.innerText = 'ğŸŒ¸'; // å¦³ä¹Ÿå¯ä»¥æ›æˆ 'ğŸ’—'
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.animationDuration = (Math.random() * 3 + 2) + 's';
            document.body.appendChild(heart);
            setTimeout(() => heart.remove(), 5000);
        }, i * 100);
    }
}

function nextLevel() {
    userData.currentLevel++;
    saveData();
    location.reload();
}

function goHome() { location.reload(); }
function shuffle(arr) { return arr.sort(() => Math.random() - 0.5); }
function saveData() { localStorage.setItem('kana_v2', JSON.stringify(userData)); }

init();
</script>
</body>
</html>